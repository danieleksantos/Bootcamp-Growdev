<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rick and Morty - Busca Global</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 1rem;
      background-color: #f4f4f4;
    }
    .c-search {
      margin-bottom: 1rem;
    }
    .c-search__input {
      padding: 0.5rem;
      width: 100%;
      max-width: 400px;
      font-size: 1rem;
    }
    .c-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
    }
    .c-card {
      background: white;
      border-radius: 0.5rem;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      overflow: hidden;
      text-align: center;
    }
    .c-card__image {
      width: 100%;
      height: auto;
    }
    .c-card__title {
      font-weight: bold;
      padding: 0.5rem;
    }
    .c-loading {
      font-size: 1rem;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <label class="c-search" for="search">
    <span class="sr-only">Buscar personagem</span>
    <input
      type="search"
      id="search"
      class="c-search__input"
      placeholder="Buscar personagem..."
    />
  </label>

  <div id="loading" class="c-loading">Carregando personagens...</div>
  <div id="charactersList" class="c-grid" hidden></div>

  <script>
    const searchInput = document.getElementById('search');
    const charactersList = document.getElementById('charactersList');
    const loading = document.getElementById('loading');

    let allCharacters = [];

    async function fetchAllCharacters() {
      let results = [];
      let nextPage = 'https://rickandmortyapi.com/api/character';

      while (nextPage) {
        const response = await fetch(nextPage);
        const data = await response.json();
        results = results.concat(data.results);
        nextPage = data.info.next;
      }

      return results;
    }

    function renderCharactersList(characters) {
      charactersList.innerHTML = characters.map(character => `
        <div class="c-card">
          <img
            class="c-card__image"
            src="${character.image}"
            alt="${character.name}"
          />
          <div class="c-card__title">${character.name}</div>
        </div>
      `).join('');
    }

    function handleSearch(event) {
      const term = event.target.value.toLowerCase();
      const filtered = allCharacters.filter(character =>
        character.name.toLowerCase().includes(term)
      );
      renderCharactersList(filtered);
    }

    searchInput.addEventListener('input', handleSearch);

    // Carrega personagens ao iniciar a pÃ¡gina
    window.addEventListener('DOMContentLoaded', async () => {
      allCharacters = await fetchAllCharacters();
      renderCharactersList(allCharacters);
      loading.hidden = true;
      charactersList.hidden = false;
    });
  </script>

</body>
</html>
